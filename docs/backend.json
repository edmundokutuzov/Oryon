
{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile within the Oryon Insurance platform (e.g., agent, claims manager, executive).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the UserProfile entity, matching Firebase Auth UID."
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
          "type": "string",
          "description": "The user's corporate email address.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "The user's role within the insurance company (e.g., 'agent', 'claims_manager', 'executive')."
        },
        "department": {
          "type": "string",
          "description": "The department the user belongs to (e.g., 'Claims', 'Sales', 'Underwriting')."
        },
        "avatar": {
          "type": "string",
          "description": "URL of the user's avatar image.",
          "format": "uri"
        },
        "permissions": {
          "type": "array",
          "description": "An array of permission strings for the user (e.g., 'approve_claim', 'view_reports').",
          "items": {
            "type": "string"
          }
        }
      },
      "required": ["id", "name", "email", "role", "department", "avatar", "permissions"]
    },
    "Policy": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Policy",
      "type": "object",
      "description": "Represents an insurance policy.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the policy." },
        "policyNumber": { "type": "string", "description": "The unique number identifying the policy." },
        "policyholderName": { "type": "string", "description": "Name of the person or entity insured." },
        "policyholderId": { "type": "string", "description": "ID of the insured client." },
        "type": { "type": "string", "enum": ["auto", "home", "life", "health"], "description": "Type of insurance policy." },
        "status": { "type": "string", "enum": ["active", "expired", "cancelled"], "description": "Current status of the policy." },
        "startDate": { "type": "string", "format": "date", "description": "The effective date of the policy." },
        "endDate": { "type": "string", "format": "date", "description": "The expiration date of the policy." },
        "premium": { "type": "number", "description": "The premium amount for the policy." },
        "coverageDetails": { "type": "string", "description": "A summary of what the policy covers." }
      },
      "required": ["id", "policyNumber", "policyholderName", "type", "status", "startDate", "endDate", "premium"]
    },
    "Claim": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Claim",
      "type": "object",
      "description": "Represents an insurance claim process from start to finish.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the claim." },
        "claimNumber": { "type": "string", "description": "The unique number identifying the claim." },
        "policyId": { "type": "string", "description": "Reference to Policy. The ID of the policy this claim is against." },
        "claimantId": { "type": "string", "description": "ID of the person making the claim." },
        "assignedManagerId": { "type": "string", "description": "Reference to UserProfile. The ID of the claims manager assigned to this claim." },
        "status": { "type": "string", "enum": ["received", "in_analysis", "inspection_scheduled", "awaiting_documents", "approved_for_payment", "closed", "denied"], "description": "The current status of the claim in the workflow." },
        "dateOfIncident": { "type": "string", "format": "date", "description": "The date the incident occurred." },
        "description": { "type": "string", "description": "A detailed description of the incident." },
        "estimatedAmount": { "type": "number", "description": "The estimated financial amount of the claim." },
        "paidAmount": { "type": "number", "description": "The final amount paid out for the claim." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of when the claim was filed." },
        "updatedAt": { "type": "string", "format": "date-time", "description": "Timestamp of when the claim was last updated." }
      },
      "required": ["id", "claimNumber", "policyId", "assignedManagerId", "status", "dateOfIncident", "description", "createdAt", "updatedAt"]
    },
    "ClaimDocument": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ClaimDocument",
      "type": "object",
      "description": "Represents a document associated with a specific claim.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the document." },
        "claimId": { "type": "string", "description": "Reference to Claim. The ID of the claim this document belongs to." },
        "documentName": { "type": "string", "description": "The name of the document (e.g., 'Police Report', 'Invoice')." },
        "fileUrl": { "type": "string", "format": "uri", "description": "The URL to the stored document in the cloud." },
        "uploadedAt": { "type": "string", "format": "date-time", "description": "Timestamp of when the document was uploaded." }
      },
      "required": ["id", "claimId", "documentName", "fileUrl", "uploadedAt"]
    },
    "ClaimTask": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ClaimTask",
      "type": "object",
      "description": "Represents a specific task to be completed as part of a claim process.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the task." },
        "claimId": { "type": "string", "description": "Reference to Claim. The ID of the claim this task belongs to." },
        "title": { "type": "string", "description": "The title of the task." },
        "type": { "type": "string", "enum": ["verification", "approval", "contact", "inspection"], "description": "The predefined type of the task." },
        "isCompleted": { "type": "boolean", "description": "Whether the task has been completed." },
        "dueDate": { "type": ["string", "null"], "format": "date", "description": "The due date for the task." }
      },
      "required": ["id", "claimId", "title", "type", "isCompleted"]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": { "$ref": "#/backend/entities/UserProfile" },
          "description": "Stores user profiles for agents, managers, and executives.",
          "params": [{ "name": "userId", "description": "The user's unique ID from Firebase Auth." }]
        }
      },
      {
        "path": "/policies/{policyId}",
        "definition": {
          "entityName": "Policy",
          "schema": { "$ref": "#/backend/entities/Policy" },
          "description": "Central collection for all insurance policies.",
          "params": [{ "name": "policyId", "description": "The unique identifier for the policy." }]
        }
      },
      {
        "path": "/claims/{claimId}",
        "definition": {
          "entityName": "Claim",
          "schema": { "$ref": "#/backend/entities/Claim" },
          "description": "Central collection for all insurance claims, serving as the core of the claims management module.",
          "params": [{ "name": "claimId", "description": "The unique identifier for the claim." }]
        }
      },
      {
        "path": "/claims/{claimId}/documents/{documentId}",
        "definition": {
          "entityName": "ClaimDocument",
          "schema": { "$ref": "#/backend/entities/ClaimDocument" },
          "description": "Sub-collection storing all documents related to a specific claim.",
          "params": [
            { "name": "claimId", "description": "The ID of the parent claim." },
            { "name": "documentId", "description": "The unique ID for the document." }
          ]
        }
      },
      {
        "path": "/claims/{claimId}/tasks/{taskId}",
        "definition": {
          "entityName": "ClaimTask",
          "schema": { "$ref": "#/backend/entities/ClaimTask" },
          "description": "Sub-collection storing all tasks associated with a specific claim.",
          "params": [
            { "name": "claimId", "description": "The ID of the parent claim." },
            { "name": "taskId", "description": "The unique ID for the task." }
          ]
        }
      }
    ],
    "reasoning": "The new Firestore structure is designed around the core entities of the insurance business: Policies and Claims. Claims are the central hub, with sub-collections for related Documents and Tasks, allowing for efficient querying and data organization within a single claim context. This structure is scalable and aligns with Firestore's best practices for managing related data."
  }
}
